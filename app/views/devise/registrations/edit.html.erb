<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-8 center">

      <h2 class="title">アカウントの編集</h2>
      <hr>

      <!--二段階認証設定-->
      <div class="margin__top__2em">
        <h4 class="title">二段階認証の設定</h4>
      </div>

      <% if user_signed_in? %>
        <% if current_user.otp_required_for_login %>
          <div class="button__area">
            <%= button_to "二段階認証を無効にする", two_factor_auth_path, method: :delete, class: "btn btn-danger", data: { confirm: '二段階認証を本当に無効にしますか?' } %>
          </div>
          <div class="text__area">
            <p class="annotation left">
              二段階認証がない場合、アカウント乗っ取りやフィッシング詐欺などのリスクが高まります。<br>
              少々面倒でも常に有効にしておくことを強くおすすめします。
            </p>
          </div>
          <hr>

        <% else %>
          <div class="button__area">
            <%= button_to "二段階認証を有効にする", new_two_factor_auth_path, method: :get, class: "btn btn-success" %>
          </div>
          <div class="text__area">
            <p class="annotation left">
              二段階認証がない場合、アカウント乗っ取りやフィッシング詐欺などのリスクが高まります。<br>
              セキュリティ向上のため、二段階認証の設定を強くおすすめします。</p>
          </div>
          <hr>
        <% end %>
      <% end %>


      <!--メールアドレス・パスワードの変更-->

      <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
        <%= render 'partial/deviseErrorMsg' %>

        <h4 class="title">メールアドレスの変更</h4>

        <div class="form-group">
          <%= f.label :メールアドレス %>
          <%= f.email_field :email, autofocus: true, class:"form-control" %>
          <p class="annotation left margin__vertical__2em">
            携帯電話のメールアドレスで登録する場合、あらかじめ携帯電話会社のメール受信設定からドメイン「giftport.jp」からのメールを受信できるようにしておいてください。
          </p>
        </div>

        <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
          <div>Currently waiting confirmation for: <%= resource.unconfirmed_email %></div>
        <% end %>

        <hr>

        <h4 class="title">パスワードの変更</h4>

        <div class="form-group">
          <%= f.label :現在のパスワード %>
          <%= f.password_field :current_password, autocomplete: "off", class:"form-control" %>
        </div>

        <div class="form-group">
          <%= f.label :新しいパスワード %>
          <% if @minimum_password_length %>
            (<%= @minimum_password_length %>文字以上)
          <% end %>
          <%= f.password_field :password, autocomplete: "off", class:"form-control" %>
        </div>

        <div class="form-group">
          <%= f.label :新しいパスワード（確認） %>
          <%= f.password_field :password_confirmation, autocomplete: "off", class:"form-control" %>
        </div>

        <div class="button__area btn-actions">
          <%= f.submit "アカウント情報を更新する", class: "btn btn-primary" %>
        </div>
      <% end %>

      <br>
      <%= link_to "前の画面に戻る", :back %>

      <hr>

      <p>
      <a data-toggle="collapse" href="#collapseDeleteAccount" aria-expanded="false" aria-controls="collapseDeleteAccount">
        <h6>アカウントを削除する</h6></a>
      </p>

      <div class="collapse" id="collapseDeleteAccount">
        <p>
          ＜ご注意＞
          一旦アカウントを削除すると二度と元に戻せません。<br>
          再度アカウントを登録の際には、プロフィールやグループなどの情報は全てはじめから作成が必要です。<br>
         <%= button_to "アカウントを削除する", registration_path(resource_name),
        data: { confirm: "
            このアカウントを削除すると、プロフィールやグループなど全ての情報が削除されます。
            再度アカウント登録の際には、全てはじめから作成が必要です。
            本当にアカウントを削除しますか？
            " },
            class: "btn btn-danger",
            method: :delete %></p>
      </div>

    </div>
  </div>
</div>
